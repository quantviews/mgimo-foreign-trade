[
  {
    "objectID": "lesson_plan_4_sessions.html#курс-международные-технологические-рынки-и-технологическое-лидерство",
    "href": "lesson_plan_4_sessions.html#курс-международные-технологические-рынки-и-технологическое-лидерство",
    "title": "",
    "section": "Курс: Международные технологические рынки и технологическое лидерство",
    "text": "Курс: Международные технологические рынки и технологическое лидерство"
  },
  {
    "objectID": "lesson_plan_4_sessions.html#мгимо-магистратура",
    "href": "lesson_plan_4_sessions.html#мгимо-магистратура",
    "title": "",
    "section": "МГИМО, магистратура",
    "text": "МГИМО, магистратура\nАвтор: Марсель Салихов\nФормат: 4 занятия по 1 часу 20 минут (80 минут каждое)\nАудитория: Магистранты-международники, прошедшие интенсивы по Python (сентябрь-декабрь)"
  },
  {
    "objectID": "lesson_plan_4_sessions.html#занятие-1-введение-в-таможенную-статистику-и-структуру-данных",
    "href": "lesson_plan_4_sessions.html#занятие-1-введение-в-таможенную-статистику-и-структуру-данных",
    "title": "",
    "section": "ЗАНЯТИЕ 1: Введение в таможенную статистику и структуру данных",
    "text": "ЗАНЯТИЕ 1: Введение в таможенную статистику и структуру данных\nДлительность: 80 минут\nЦели занятия:\n\nПонять, как устроена таможенная статистика\nИзучить структуру данных проекта\nПознакомиться с основными понятиями (ТН ВЭД, зеркальная статистика, источники данных)\n\nСтруктура занятия:\nЧасть 1: Теоретический блок (25 минут)\n1.1. Что такое таможенная статистика? (10 мин) - Определение и назначение - Кто собирает данные: ФТС России, национальные таможенные службы, UN Comtrade - Основные показатели: стоимость (STOIM), вес нетто (NETTO), количество (KOL) - Направления торговли: импорт (ИМ) и экспорт (ЭК)\n1.2. Товарная номенклатура ТН ВЭД (10 мин) - Что такое ТН ВЭД и зачем она нужна - Иерархия кодов: TNVED2 (группа), TNVED4 (позиция), TNVED6 (субпозиция), TNVED8-10 (детализация) - Примеры: 01 (живые животные), 0101 (лошади, ослы, мулы), 010121 (лошади чистокровные) - Практический пример: найти код для конкретного товара\n1.3. Зеркальная статистика: что это и зачем? (5 мин) - Определение: статистика страны-партнера о торговле с РФ - Почему она важна: когда официальная статистика недоступна - Источники: национальные таможенные службы (Китай, Индия, Турция), UN Comtrade\nЧасть 2: Структура проекта (20 минут)\n2.1. Обзор проекта “Актуальная статистика внешней торговли” (10 мин) - Демонстрация структуры проекта (через файловую систему или презентацию) - Основные компоненты: - src/collectors/ - сборщики данных (Китай, Индия, Турция) - data_processed/ - обработанные данные в формате Parquet - db/ - база данных DuckDB - superset/ - конфигурация дашборда\n2.2. Модель данных (10 мин) - Демонстрация схемы данных из docs/data_model.md - Основные поля: - NAPR - направление (ИМ/ЭК) - PERIOD - период (дата) - STRANA - страна-партнер (ISO2 код) - TNVED, TNVED2, TNVED4, TNVED6 - товарные коды - STOIM - стоимость в тысячах USD - NETTO - вес нетто в кг - KOL - количество в дополнительной единице - EDIZM - единица измерения - Пример записи данных\nЧасть 3: Практическая работа (30 минут)\n3.1. Подготовка окружения (5 мин) - Проверка установки Python, pandas, duckdb - Клонирование/открытие проекта - Настройка рабочей директории\n3.2. Первое знакомство с данными (25 мин) - Загрузка данных из DuckDB в pandas DataFrame - Базовые операции: python   import duckdb   import pandas as pd   conn = duckdb.connect('db/unified_trade_data.duckdb')   df = conn.execute(\"SELECT * FROM unified_trade_data LIMIT 1000\").df() - Изучение структуры: df.info(), df.head(), df.describe() - Простые запросы: - Сколько записей по странам? - Какой временной период покрывают данные? - Какие товарные группы (TNVED2) наиболее представлены?\nЧасть 4: Подведение итогов (5 минут)\n\nКраткое резюме: что узнали\nВопросы студентов\nДомашнее задание (опционально): изучить документацию docs/data_model.md"
  },
  {
    "objectID": "lesson_plan_4_sessions.html#занятие-2-старая-и-новая-статистика-работа-с-данными-до-и-после-января-2022",
    "href": "lesson_plan_4_sessions.html#занятие-2-старая-и-новая-статистика-работа-с-данными-до-и-после-января-2022",
    "title": "",
    "section": "ЗАНЯТИЕ 2: Старая и новая статистика: работа с данными до и после января 2022",
    "text": "ЗАНЯТИЕ 2: Старая и новая статистика: работа с данными до и после января 2022\nДлительность: 80 минут\nЦели занятия:\n\nПонять разницу между старой статистикой ФТС и новой зеркальной статистикой\nНаучиться работать с данными разных периодов\nОсвоить базовые аналитические запросы\n\nСтруктура занятия:\nЧасть 1: Теоретический блок (20 минут)\n1.1. Исторический контекст (10 мин) - До января 2022: официальная статистика ФТС России - Прямые данные от российской таможни - Высокая детализация и точность - Доступность данных через официальные каналы - После января 2022: переход на зеркальную статистику - Официальная статистика РФ стала недоступна - Использование данных стран-партнеров - Данные из UN Comtrade как дополнительный источник\n1.2. Различия в источниках данных (10 мин) - Национальные источники (Китай, Индия, Турция): - Структура данных на сайтах таможенных служб - Особенности сбора и обработки - Преимущества: оперативность, детализация - UN Comtrade: - Что такое Comtrade и как он работает - Зеркальная статистика: как страна-партнер видит торговлю с РФ - Ограничения: задержка публикации, уровень агрегации\nЧасть 2: Практическая работа со старой статистикой (25 минут)\n2.1. Загрузка и изучение данных до 2022 года (10 мин)\n# Фильтрация данных до января 2022\ndf_old = conn.execute(\"\"\"\n    SELECT * \n    FROM unified_trade_data \n    WHERE PERIOD &lt; '2022-01-01'\n    LIMIT 5000\n\"\"\").df()\n\n# Анализ структуры\nprint(f\"Период: {df_old['PERIOD'].min()} - {df_old['PERIOD'].max()}\")\nprint(f\"Страны: {df_old['STRANA'].unique()}\")\nprint(f\"Источники: {df_old['SOURCE'].value_counts() if 'SOURCE' in df_old.columns else 'N/A'}\")\n2.2. Анализ старой статистики (15 мин) - Топ-10 стран-партнеров по импорту в 2021 году: python   top_import_2021 = conn.execute(\"\"\"       SELECT STRANA, SUM(STOIM) as total_import       FROM unified_trade_data       WHERE PERIOD &gt;= '2021-01-01' AND PERIOD &lt; '2022-01-01'         AND NAPR = 'ИМ'       GROUP BY STRANA       ORDER BY total_import DESC       LIMIT 10   \"\"\").df() - Динамика экспорта по месяцам 2021: python   export_dynamics = conn.execute(\"\"\"       SELECT PERIOD, SUM(STOIM) as total_export       FROM unified_trade_data       WHERE PERIOD &gt;= '2021-01-01' AND PERIOD &lt; '2022-01-01'         AND NAPR = 'ЭК'       GROUP BY PERIOD       ORDER BY PERIOD   \"\"\").df()\nЧасть 3: Практическая работа с новой статистикой (30 минут)\n3.1. Загрузка данных после января 2022 (10 мин)\n# Фильтрация данных после января 2022\ndf_new = conn.execute(\"\"\"\n    SELECT * \n    FROM unified_trade_data \n    WHERE PERIOD &gt;= '2022-01-01'\n    LIMIT 5000\n\"\"\").df()\n\n# Анализ источников данных\nif 'SOURCE' in df_new.columns:\n    print(df_new['SOURCE'].value_counts())\n3.2. Сравнительный анализ (20 мин) - Сравнение структуры торговли до и после 2022: ```python # Топ-5 стран-партнеров до и после before_2022 = conn.execute(““” SELECT STRANA, SUM(STOIM) as total FROM unified_trade_data WHERE PERIOD &gt;= ‘2021-01-01’ AND PERIOD &lt; ‘2022-01-01’ AND NAPR = ‘ИМ’ GROUP BY STRANA ORDER BY total DESC LIMIT 5 “““).df()\nafter_2022 = conn.execute(““” SELECT STRANA, SUM(STOIM) as total FROM unified_trade_data WHERE PERIOD &gt;= ‘2022-01-01’ AND NAPR = ‘ИМ’ GROUP BY STRANA ORDER BY total DESC LIMIT 5 “““).df() - Визуализация изменений (если время позволяет):python import matplotlib.pyplot as plt # Простой график динамики ```\nЧасть 4: Подведение итогов (5 минут)\n\nКлючевые выводы о различиях старой и новой статистики\nВопросы студентов\nДомашнее задание: провести собственный сравнительный анализ по выбранной стране или товарной группе"
  },
  {
    "objectID": "lesson_plan_4_sessions.html#занятие-3-duckdb-и-практическая-работа-с-данными",
    "href": "lesson_plan_4_sessions.html#занятие-3-duckdb-и-практическая-работа-с-данными",
    "title": "",
    "section": "ЗАНЯТИЕ 3: DuckDB и практическая работа с данными",
    "text": "ЗАНЯТИЕ 3: DuckDB и практическая работа с данными\nДлительность: 80 минут\nЦели занятия:\n\nПонять, что такое DuckDB и почему он используется в проекте\nОсвоить SQL-запросы для работы с данными\nНаучиться выполнять аналитические задачи\n\nСтруктура занятия:\nЧасть 1: Введение в DuckDB (15 минут)\n1.1. Что такое DuckDB? (10 мин) - Определение: аналитическая СУБД, оптимизированная для аналитических запросов - Преимущества: - Работа с файлами (Parquet, CSV) без установки сервера - Высокая скорость выполнения аналитических запросов - SQL-интерфейс, знакомый многим - Эффективная работа с большими объемами данных - Сравнение с другими решениями (PostgreSQL, SQLite)\n1.2. Структура базы данных проекта (5 мин) - Основная таблица: unified_trade_data - Справочные таблицы: country_reference, tnved_reference - Представления (views): unified_trade_data_enriched - Демонстрация структуры через SQL: sql   SHOW TABLES;   DESCRIBE unified_trade_data;\nЧасть 2: Основы SQL для анализа данных (25 минут)\n2.1. Базовые запросы (10 мин) - SELECT, WHERE, GROUP BY, ORDER BY - Агрегатные функции: SUM, COUNT, AVG, MIN, MAX - Примеры: sql   -- Общая стоимость импорта по странам за 2023 год   SELECT STRANA, SUM(STOIM) as total_import   FROM unified_trade_data   WHERE PERIOD &gt;= '2023-01-01' AND PERIOD &lt; '2024-01-01'     AND NAPR = 'ИМ'   GROUP BY STRANA   ORDER BY total_import DESC   LIMIT 10;\n2.2. JOIN и работа со справочниками (15 мин) - Использование unified_trade_data_enriched для получения названий стран и товаров: sql   SELECT        COUNTRY_NAME,       TNVED2_NAME,       SUM(STOIM) as total_value   FROM unified_trade_data_enriched   WHERE PERIOD &gt;= '2023-01-01'     AND NAPR = 'ИМ'   GROUP BY COUNTRY_NAME, TNVED2_NAME   ORDER BY total_value DESC   LIMIT 20; - Работа с физическими объемами: sql   -- Импорт по весу (NETTO) и стоимости   SELECT        STRANA,       SUM(STOIM) as total_value_usd,       SUM(NETTO) as total_weight_kg,       SUM(STOIM) / NULLIF(SUM(NETTO), 0) as price_per_kg   FROM unified_trade_data   WHERE PERIOD &gt;= '2023-01-01' AND PERIOD &lt; '2024-01-01'     AND NAPR = 'ИМ'     AND NETTO &gt; 0   GROUP BY STRANA   HAVING SUM(NETTO) &gt; 1000000  -- более 1 млн кг   ORDER BY total_value_usd DESC;\nЧасть 3: Практические аналитические задачи (35 минут)\n3.1. Задача 1: Анализ товарной структуры (15 мин) - Топ-10 товарных групп (TNVED2) по импорту за последний год: sql   SELECT        t.TNVED2_NAME,       SUM(t.STOIM) as total_import,       COUNT(DISTINCT t.STRANA) as num_countries   FROM unified_trade_data_enriched t   WHERE t.PERIOD &gt;= DATE_TRUNC('year', CURRENT_DATE) - INTERVAL '1 year'     AND t.NAPR = 'ИМ'   GROUP BY t.TNVED2_NAME   ORDER BY total_import DESC   LIMIT 10;\n3.2. Задача 2: Динамика торговли (10 мин) - Месячная динамика экспорта и импорта: sql   SELECT        PERIOD,       SUM(CASE WHEN NAPR = 'ИМ' THEN STOIM ELSE 0 END) as import_value,       SUM(CASE WHEN NAPR = 'ЭК' THEN STOIM ELSE 0 END) as export_value   FROM unified_trade_data   WHERE PERIOD &gt;= '2023-01-01'   GROUP BY PERIOD   ORDER BY PERIOD;\n3.3. Задача 3: Анализ физических объемов (10 мин) - Товары с наибольшим физическим объемом импорта: sql   SELECT        t.TNVED4_NAME,       SUM(t.NETTO) as total_weight_kg,       SUM(t.STOIM) as total_value_usd,       AVG(t.STOIM / NULLIF(t.NETTO, 0)) as avg_price_per_kg   FROM unified_trade_data_enriched t   WHERE t.PERIOD &gt;= '2023-01-01'     AND t.NAPR = 'ИМ'     AND t.NETTO &gt; 0   GROUP BY t.TNVED4_NAME   HAVING SUM(t.NETTO) &gt; 10000000  -- более 10 млн кг   ORDER BY total_weight_kg DESC   LIMIT 10;\nЧасть 4: Экспорт данных и подведение итогов (5 минут)\n\nЭкспорт результатов в CSV:\nresult_df = conn.execute(\"\"\"\n    -- ваш SQL запрос\n\"\"\").df()\nresult_df.to_csv('export_analysis.csv', index=False)\nВопросы студентов\nДомашнее задание: выполнить собственный аналитический запрос по интересующей теме"
  },
  {
    "objectID": "lesson_plan_4_sessions.html#занятие-4-superset-дашборд-и-визуализация-данных",
    "href": "lesson_plan_4_sessions.html#занятие-4-superset-дашборд-и-визуализация-данных",
    "title": "",
    "section": "ЗАНЯТИЕ 4: Superset дашборд и визуализация данных",
    "text": "ЗАНЯТИЕ 4: Superset дашборд и визуализация данных\nДлительность: 80 минут\nЦели занятия:\n\nПонять, что такое Superset и как он работает\nИзучить структуру дашборда проекта\nНаучиться создавать простые визуализации\nПонять, как дашборд подключается к DuckDB\n\nСтруктура занятия:\nЧасть 1: Введение в Apache Superset (20 минут)\n1.1. Что такое Superset? (10 мин) - Определение: open-source платформа для визуализации данных и бизнес-аналитики - Основные возможности: - Подключение к различным базам данных (включая DuckDB) - Создание интерактивных дашбордов - Различные типы визуализаций (графики, таблицы, карты) - SQL Lab для выполнения запросов - Преимущества использования Superset для аналитики\n1.2. Архитектура Superset в проекте (10 мин) - Демонстрация конфигурации (superset/superset_config.py) - Подключение к DuckDB через SQLAlchemy - Структура дашборда: - Источники данных (datasources) - Чарты (charts) - Дашборды (dashboards) - Демонстрация работающего дашборда (если доступен)\nЧасть 2: Структура дашборда проекта (25 минут)\n2.1. Обзор дашборда (10 мин) - Демонстрация основных элементов дашборда: - Общая статистика (тоталы по импорту/экспорту) - Динамика по месяцам - Топ стран-партнеров - Товарная структура - Фильтры по периоду, стране, товарной группе\n2.2. Типы визуализаций в дашборде (15 мин) - Временные ряды (Time Series): - Динамика импорта/экспорта по месяцам - Сравнение периодов - Столбчатые диаграммы (Bar Chart): - Топ стран-партнеров - Топ товарных групп - Таблицы (Table): - Детализированные данные - Возможность экспорта - Круговые диаграммы (Pie Chart): - Структура торговли по странам - Структура по товарным группам\nЧасть 3: Практическая работа с дашбордом (30 минут)\n3.1. Навигация по дашборду (10 мин) - Как использовать фильтры - Как взаимодействовать с графиками (zoom, drill-down) - Как экспортировать данные - Практическое задание: найти данные по конкретной стране за определенный период\n3.2. SQL Lab в Superset (10 мин) - Демонстрация SQL Lab для выполнения запросов - Примеры запросов: sql   -- Простой запрос для проверки данных   SELECT        PERIOD,       STRANA,       SUM(STOIM) as total   FROM unified_trade_data   WHERE PERIOD &gt;= '2023-01-01'   GROUP BY PERIOD, STRANA   ORDER BY PERIOD DESC, total DESC   LIMIT 100; - Создание простой визуализации из результата запроса\n3.3. Создание простого чарта (10 мин) - Пошаговое создание простого графика: 1. Выбор источника данных 2. Выбор типа визуализации 3. Настройка метрик и измерений 4. Применение фильтров 5. Сохранение чарта - Пример: график динамики импорта из Китая за 2023 год\nЧасть 4: Интеграция DuckDB и Superset (5 минут)\n4.1. Как работает подключение (5 мин) - Конфигурация подключения к DuckDB в Superset - Особенности работы с DuckDB: - Прямое чтение файлов Parquet - Высокая скорость выполнения запросов - Поддержка SQL стандарта - Преимущества использования DuckDB для аналитики\nЧасть 5: Подведение итогов курса (10 минут)\n5.1. Резюме всех занятий (5 мин) - Что узнали: - Структура таможенной статистики - Различия старой и новой статистики - Работа с DuckDB и SQL - Визуализация данных в Superset\n5.2. Практическое применение (3 мин) - Как использовать полученные знания в профессиональной деятельности - Возможности для дальнейшего изучения\n5.3. Вопросы и обратная связь (2 мин) - Ответы на вопросы студентов - Сбор обратной связи о курсе"
  },
  {
    "objectID": "lesson_plan_4_sessions.html#презентации-и-практика",
    "href": "lesson_plan_4_sessions.html#презентации-и-практика",
    "title": "",
    "section": "Презентации и практика",
    "text": "Презентации и практика\n\nПрезентации (Quarto): lessons/lesson_01_intro.qmd … lesson_04_superset.qmd\nРендер: quarto render lessons/*.qmd\nПрактика (Python): lessons/practices/practice_01_intro.py … practice_04_superset.py\nSuperset: Доступ к инстансу предоставляется отдельно"
  },
  {
    "objectID": "lesson_plan_4_sessions.html#материалы-для-подготовки-к-занятиям",
    "href": "lesson_plan_4_sessions.html#материалы-для-подготовки-к-занятиям",
    "title": "",
    "section": "Материалы для подготовки к занятиям",
    "text": "Материалы для подготовки к занятиям\nНеобходимое ПО:\n\nPython 3.8+\nБиблиотеки: pandas, duckdb\nБраузер для работы с Superset (если дашборд развернут)\n\nДокументация проекта:\n\ndocs/data_model.md - модель данных\ndocs/merge_processed_data-docs.md - описание процесса обработки данных\nproject_architecture.md - архитектура проекта\n\nДополнительные ресурсы:\n\nДокументация DuckDB: https://duckdb.org/docs/\nДокументация Apache Superset: https://superset.apache.org/docs/\nUN Comtrade: https://comtradeplus.un.org/"
  },
  {
    "objectID": "lesson_plan_4_sessions.html#рекомендации-по-проведению-занятий",
    "href": "lesson_plan_4_sessions.html#рекомендации-по-проведению-занятий",
    "title": "",
    "section": "Рекомендации по проведению занятий",
    "text": "Рекомендации по проведению занятий\n\nАдаптация под уровень студентов:\n\nЕсли уровень Python низкий: больше времени на базовые операции с pandas\nЕсли уровень высокий: можно добавить более сложные аналитические задачи\n\nИнтерактивность:\n\nПоощрять вопросы во время занятия\nИспользовать практические примеры из реальных данных\nПредлагать студентам выполнять запросы самостоятельно\n\nПрактические задания:\n\nПосле каждого занятия можно давать небольшие задания\nФинальное задание: создать собственный анализ по выбранной теме\n\nТехнические моменты:\n\nУбедиться, что у всех студентов установлено необходимое ПО\nПодготовить примеры данных для работы\nИметь резервный план на случай технических проблем"
  },
  {
    "objectID": "lesson_03_duckdb.html#план-занятия-80-мин",
    "href": "lesson_03_duckdb.html#план-занятия-80-мин",
    "title": "Занятие 3. DuckDB и практическая работа с данными",
    "section": "План занятия (80 мин)",
    "text": "План занятия (80 мин)\n\nВведение в DuckDB (15 мин)\nОсновы SQL (25 мин): SELECT, WHERE, GROUP BY, JOIN\nПрактические задачи (35 мин): Товарная структура, динамика, физические объёмы\nЭкспорт и итоги (5 мин)"
  },
  {
    "objectID": "lesson_03_duckdb.html#что-такое-duckdb",
    "href": "lesson_03_duckdb.html#что-такое-duckdb",
    "title": "Занятие 3. DuckDB и практическая работа с данными",
    "section": "Что такое DuckDB?",
    "text": "Что такое DuckDB?\nDuckDB — быстрая аналитическая СУБД, встроенная в приложение (embedded).\n\n\n\nОсобенность\nОписание\n\n\n\n\nТип\nIn-process, не требует сервера\n\n\nОптимизация\nДля аналитических запросов (OLAP)\n\n\nФайлы\nРабота с Parquet, CSV напрямую\n\n\nSQL\nСтандартный SQL\n\n\nСкорость\nВысокая на агрегациях и JOIN\n\n\n\nСравнение: SQLite — транзакции, малые объёмы; DuckDB — аналитика, большие данные."
  },
  {
    "objectID": "lesson_03_duckdb.html#структура-бд-проекта",
    "href": "lesson_03_duckdb.html#структура-бд-проекта",
    "title": "Занятие 3. DuckDB и практическая работа с данными",
    "section": "Структура БД проекта",
    "text": "Структура БД проекта\nunified_trade_data.duckdb\n├── unified_trade_data      # Основная таблица\n├── country_reference      # STRANA → название страны\n├── tnved_reference        # TNVED_CODE → название товара\n├── unified_trade_data_enriched  # VIEW с JOIN справочников\n└── fizob_index (опц.)     # Физические объёмы\nРекомендация: Для аналитики с названиями используйте unified_trade_data_enriched."
  },
  {
    "objectID": "lesson_03_duckdb.html#просмотр-структуры",
    "href": "lesson_03_duckdb.html#просмотр-структуры",
    "title": "Занятие 3. DuckDB и практическая работа с данными",
    "section": "Просмотр структуры",
    "text": "Просмотр структуры\nimport duckdb\nconn = duckdb.connect(\"db/unified_trade_data.duckdb\")\n\n# Список таблиц\ntables = conn.execute(\"SHOW TABLES\").fetchall()\nprint(\"Таблицы:\", tables)\n\n# Схема основной таблицы\nschema = conn.execute(\"DESCRIBE unified_trade_data\").df()\nprint(schema)"
  },
  {
    "objectID": "lesson_03_duckdb.html#базовый-sql-select-where-group-by",
    "href": "lesson_03_duckdb.html#базовый-sql-select-where-group-by",
    "title": "Занятие 3. DuckDB и практическая работа с данными",
    "section": "Базовый SQL: SELECT, WHERE, GROUP BY",
    "text": "Базовый SQL: SELECT, WHERE, GROUP BY\n-- Импорт по странам за 2023\nSELECT STRANA, SUM(STOIM) as total_import\nFROM unified_trade_data\nWHERE PERIOD &gt;= '2023-01-01' AND PERIOD &lt; '2024-01-01'\n  AND NAPR = 'ИМ'\nGROUP BY STRANA\nORDER BY total_import DESC\nLIMIT 10;\nКлючевые элементы: WHERE (фильтр), GROUP BY (агрегация), ORDER BY (сортировка), LIMIT (ограничение)."
  },
  {
    "objectID": "lesson_03_duckdb.html#агрегатные-функции",
    "href": "lesson_03_duckdb.html#агрегатные-функции",
    "title": "Занятие 3. DuckDB и практическая работа с данными",
    "section": "Агрегатные функции",
    "text": "Агрегатные функции\n\n\n\nФункция\nОписание\n\n\n\n\nSUM()\nСумма\n\n\nCOUNT()\nКоличество\n\n\nAVG()\nСреднее\n\n\nMIN(), MAX()\nМинимум, максимум\n\n\nCOUNT(DISTINCT x)\nУникальные значения\n\n\n\nSELECT \n    STRANA,\n    COUNT(*) as records,\n    SUM(STOIM) as total_value,\n    AVG(NETTO) as avg_weight\nFROM unified_trade_data\nWHERE PERIOD &gt;= '2023-01-01' AND NAPR = 'ИМ'\nGROUP BY STRANA;"
  },
  {
    "objectID": "lesson_03_duckdb.html#view-unified_trade_data_enriched",
    "href": "lesson_03_duckdb.html#view-unified_trade_data_enriched",
    "title": "Занятие 3. DuckDB и практическая работа с данными",
    "section": "VIEW unified_trade_data_enriched",
    "text": "VIEW unified_trade_data_enriched\nСодержит JOIN с справочниками — готовые названия стран и товаров.\nSELECT \n    COUNTRY_NAME,\n    TNVED2_NAME,\n    SUM(STOIM) as total_value\nFROM unified_trade_data_enriched\nWHERE PERIOD &gt;= '2023-01-01' AND NAPR = 'ИМ'\nGROUP BY COUNTRY_NAME, TNVED2_NAME\nORDER BY total_value DESC\nLIMIT 20;\nКолонки: COUNTRY_NAME, TNVED2_NAME, TNVED4_NAME, TNVED6_NAME, TNVED_NAME, period_rank."
  },
  {
    "objectID": "lesson_03_duckdb.html#работа-с-физическими-объёмами",
    "href": "lesson_03_duckdb.html#работа-с-физическими-объёмами",
    "title": "Занятие 3. DuckDB и практическая работа с данными",
    "section": "Работа с физическими объёмами",
    "text": "Работа с физическими объёмами\nSELECT \n    STRANA,\n    SUM(STOIM) as total_value_usd,\n    SUM(NETTO) as total_weight_kg,\n    SUM(STOIM) / NULLIF(SUM(NETTO), 0) as price_per_kg\nFROM unified_trade_data\nWHERE PERIOD &gt;= '2023-01-01' AND PERIOD &lt; '2024-01-01'\n  AND NAPR = 'ИМ' AND NETTO &gt; 0\nGROUP BY STRANA\nHAVING SUM(NETTO) &gt; 1000000\nORDER BY total_value_usd DESC;\nNULLIF(a, 0) — избегает деления на ноль. HAVING — фильтр после GROUP BY."
  },
  {
    "objectID": "lesson_03_duckdb.html#практика-1-топ-товарных-групп-по-импорту",
    "href": "lesson_03_duckdb.html#практика-1-топ-товарных-групп-по-импорту",
    "title": "Занятие 3. DuckDB и практическая работа с данными",
    "section": "Практика 1: Топ товарных групп по импорту",
    "text": "Практика 1: Топ товарных групп по импорту\nconn = duckdb.connect(\"db/unified_trade_data.duckdb\")\n\ntop_groups = conn.execute(\"\"\"\n    SELECT \n        TNVED2_NAME,\n        SUM(STOIM) as total_import,\n        COUNT(DISTINCT STRANA) as num_countries\n    FROM unified_trade_data_enriched\n    WHERE PERIOD &gt;= '2023-01-01' AND NAPR = 'ИМ'\n    GROUP BY TNVED2_NAME\n    ORDER BY total_import DESC\n    LIMIT 10\n\"\"\").df()\n\nprint(top_groups)"
  },
  {
    "objectID": "lesson_03_duckdb.html#практика-2-месячная-динамика-импорта-и-экспорта",
    "href": "lesson_03_duckdb.html#практика-2-месячная-динамика-импорта-и-экспорта",
    "title": "Занятие 3. DuckDB и практическая работа с данными",
    "section": "Практика 2: Месячная динамика импорта и экспорта",
    "text": "Практика 2: Месячная динамика импорта и экспорта\ndynamics = conn.execute(\"\"\"\n    SELECT \n        PERIOD,\n        SUM(CASE WHEN NAPR = 'ИМ' THEN STOIM ELSE 0 END) as import_value,\n        SUM(CASE WHEN NAPR = 'ЭК' THEN STOIM ELSE 0 END) as export_value\n    FROM unified_trade_data\n    WHERE PERIOD &gt;= '2023-01-01'\n    GROUP BY PERIOD\n    ORDER BY PERIOD\n\"\"\").df()\n\nprint(dynamics)"
  },
  {
    "objectID": "lesson_03_duckdb.html#практика-3-товары-с-наибольшим-весом",
    "href": "lesson_03_duckdb.html#практика-3-товары-с-наибольшим-весом",
    "title": "Занятие 3. DuckDB и практическая работа с данными",
    "section": "Практика 3: Товары с наибольшим весом",
    "text": "Практика 3: Товары с наибольшим весом\nby_weight = conn.execute(\"\"\"\n    SELECT \n        TNVED4_NAME,\n        SUM(NETTO) as total_weight_kg,\n        SUM(STOIM) as total_value_usd\n    FROM unified_trade_data_enriched\n    WHERE PERIOD &gt;= '2023-01-01' AND NAPR = 'ИМ' AND NETTO &gt; 0\n    GROUP BY TNVED4_NAME\n    HAVING SUM(NETTO) &gt; 10000000\n    ORDER BY total_weight_kg DESC\n    LIMIT 10\n\"\"\").df()\n\nprint(by_weight)"
  },
  {
    "objectID": "lesson_03_duckdb.html#практика-4-импорт-по-странам-с-названиями",
    "href": "lesson_03_duckdb.html#практика-4-импорт-по-странам-с-названиями",
    "title": "Занятие 3. DuckDB и практическая работа с данными",
    "section": "Практика 4: Импорт по странам с названиями",
    "text": "Практика 4: Импорт по странам с названиями\nimport_countries = conn.execute(\"\"\"\n    SELECT \n        COUNTRY_NAME,\n        SUM(STOIM) as total_import,\n        SUM(NETTO) as total_weight\n    FROM unified_trade_data_enriched\n    WHERE PERIOD &gt;= '2023-01-01' AND NAPR = 'ИМ'\n    GROUP BY COUNTRY_NAME\n    ORDER BY total_import DESC\n    LIMIT 15\n\"\"\").df()\n\nprint(import_countries)"
  },
  {
    "objectID": "lesson_03_duckdb.html#практика-5-экспорт-в-csv",
    "href": "lesson_03_duckdb.html#практика-5-экспорт-в-csv",
    "title": "Занятие 3. DuckDB и практическая работа с данными",
    "section": "Практика 5: Экспорт в CSV",
    "text": "Практика 5: Экспорт в CSV\nresult = conn.execute(\"\"\"\n    SELECT STRANA, TNVED2, SUM(STOIM) as total\n    FROM unified_trade_data\n    WHERE PERIOD &gt;= '2023-01-01' AND NAPR = 'ИМ'\n    GROUP BY STRANA, TNVED2\n    ORDER BY total DESC\n\"\"\").df()\n\nresult.to_csv('export_analysis.csv', index=False)\nprint(f\"Экспортировано {len(result)} строк в export_analysis.csv\")"
  },
  {
    "objectID": "lesson_03_duckdb.html#итоги-занятия-3",
    "href": "lesson_03_duckdb.html#итоги-занятия-3",
    "title": "Занятие 3. DuckDB и практическая работа с данными",
    "section": "Итоги занятия 3",
    "text": "Итоги занятия 3\n\nDuckDB — аналитическая СУБД, быстрые запросы, работа с файлами\nSQL: SELECT, WHERE, GROUP BY, HAVING, ORDER BY, агрегаты\nunified_trade_data_enriched — VIEW с названиями стран и товаров\nПрактика: Товарная структура, динамика, физические объёмы, экспорт\n\nДомашнее задание: Выполнить собственный аналитический запрос (например: топ-5 товарных позиций TNVED4 по экспорту в выбранную страну за 2023)."
  },
  {
    "objectID": "lesson_01_intro.html#план-занятия-80-мин",
    "href": "lesson_01_intro.html#план-занятия-80-мин",
    "title": "Занятие 1. Введение в таможенную статистику",
    "section": "План занятия (80 мин)",
    "text": "План занятия (80 мин)\n\nТеория (25 мин): Таможенная статистика, ТН ВЭД, зеркальная статистика\nСтруктура проекта (20 мин): Обзор проекта «Актуальная статистика внешней торговли»\nПрактика (30 мин): Первое знакомство с данными в Python\nИтоги (5 мин)"
  },
  {
    "objectID": "lesson_01_intro.html#что-такое-таможенная-статистика",
    "href": "lesson_01_intro.html#что-такое-таможенная-статистика",
    "title": "Занятие 1. Введение в таможенную статистику",
    "section": "Что такое таможенная статистика?",
    "text": "Что такое таможенная статистика?\nОпределение: Систематизированные данные о внешней торговле страны, формируемые на основе таможенных деклараций.\nКто собирает:\n\nФТС России — до января 2022 публиковала детальную статистику\nНациональные таможенные службы — Китай, Индия, Турция и др.\nUN Comtrade — агрегированная международная база ООН\n\nОсновные показатели:\n\n\n\nПоказатель\nОписание\nЕдиница\n\n\n\n\nSTOIM\nСтатистическая стоимость\nтыс. USD\n\n\nNETTO\nВес нетто\nкг\n\n\nKOL\nКоличество в доп. единице\nшт, л, м³ и т.д."
  },
  {
    "objectID": "lesson_01_intro.html#направления-торговли-napr",
    "href": "lesson_01_intro.html#направления-торговли-napr",
    "title": "Занятие 1. Введение в таможенную статистику",
    "section": "Направления торговли (NAPR)",
    "text": "Направления торговли (NAPR)\n\n\nИМ (Импорт) — товары, ввозимые в РФ\n\nС точки зрения РФ: что мы покупаем за рубежом\nПример: китайский экспорт в РФ = российский импорт из Китая\n\n\nЭК (Экспорт) — товары, вывозимые из РФ\n\nС точки зрения РФ: что мы продаём за рубеж\nПример: российский экспорт в Турцию = турецкий импорт из РФ\n\n\nВажно: При работе с зеркальной статистикой направление «отзеркаливается» — экспорт партнёра становится нашим импортом."
  },
  {
    "objectID": "lesson_01_intro.html#классификатор-стран-strana",
    "href": "lesson_01_intro.html#классификатор-стран-strana",
    "title": "Занятие 1. Введение в таможенную статистику",
    "section": "Классификатор стран (STRANA)",
    "text": "Классификатор стран (STRANA)\nСправочник: metadata/STRANA.csv — соответствие кодов стран и их названий.\n\n\n\nКолонка\nОписание\n\n\n\n\nKOD\nДвухбуквенный код ISO 3166-1 alpha-2 (CN, RU, US…)\n\n\nNAME\nОфициальное наименование страны на русском\n\n\n\nОбъём: 254 записи (страны и территории). В данных ФТС используется код страны-партнёра по сделке."
  },
  {
    "objectID": "lesson_01_intro.html#примеры-кодов-стран-из-strana.csv",
    "href": "lesson_01_intro.html#примеры-кодов-стран-из-strana.csv",
    "title": "Занятие 1. Введение в таможенную статистику",
    "section": "Примеры кодов стран (из STRANA.csv)",
    "text": "Примеры кодов стран (из STRANA.csv)\n\n\n\nКод\nСтрана\n\n\n\n\nCN\nКИТАЙ\n\n\nRU\nРОССИЯ\n\n\nUS\nСОЕДИДИНЕННЫЕ ШТАТЫ\n\n\nDE\nГЕРМАНИЯ\n\n\nBY\nБЕЛАРУСЬ\n\n\nKZ\nКАЗАХСТАН\n\n\nTR\nТУРЦИЯ\n\n\nIN\nИНДИЯ\n\n\nKR\nКОРЕЯ, РЕСПУБЛИКА\n\n\nJP\nЯПОНИЯ\n\n\nUA\nУКРАИНА\n\n\nGB\nСОЕДИНЕННОЕ КОРОЛЕВСТВО\n\n\n\nСпециальные коды: EU — страны ЕС, NNN — неизвестная страна, AB/OS — Абхазия/Южная Осетия.\nИспользование: В торговых данных колонка STRANA содержит только код. Для получения названия — JOIN со справочником:\n\nimport pandas as pd\nfrom pathlib import Path\n# Корень проекта (при quarto render cwd часто = lessons/)\nROOT = Path.cwd().parent if (Path.cwd().parent / \"metadata\").exists() else Path.cwd()\nstrana = pd.read_csv(ROOT / \"metadata\" / \"STRANA.csv\", sep=\"\\t\")\n# Объединение с данными: df.merge(strana, left_on=\"STRANA\", right_on=\"KOD\")"
  },
  {
    "objectID": "lesson_01_intro.html#что-такое-тн-вэд-и-зачем-он-нужен",
    "href": "lesson_01_intro.html#что-такое-тн-вэд-и-зачем-он-нужен",
    "title": "Занятие 1. Введение в таможенную статистику",
    "section": "Что такое ТН ВЭД и зачем он нужен?",
    "text": "Что такое ТН ВЭД и зачем он нужен?\nОпределение: ТН ВЭД — классификатор товаров, используемый таможенными органами (ФТС России) для таможенных операций, применения пошлин и ведения статистики.\n\nФундамент: В основе — Гармонизированная система (HS) Всемирной таможенной организации\nОбъём в проекте: В metadata/tnved.csv — 31 532 записи по 5 уровням вложенности\nПринцип: «От общего к частному» — с увеличением длины кода описание товара становится детальнее"
  },
  {
    "objectID": "lesson_01_intro.html#иерархическая-структура-кода-10-знаков",
    "href": "lesson_01_intro.html#иерархическая-структура-кода-10-знаков",
    "title": "Занятие 1. Введение в таможенную статистику",
    "section": "Иерархическая структура кода (10 знаков)",
    "text": "Иерархическая структура кода (10 знаков)\n5 уровней классификации в metadata/tnved.csv:\n\n\n\n\n\n\n\n\n\nЗнаков\nУровень\nПример\nРоль\n\n\n\n\n2\nГруппа\n01\nМатериал/отрасль (97 групп)\n\n\n4\nТоварная позиция\n0101\nУзкая категория (1 231 позиция)\n\n\n6\nСубпозиция\n010121\nУровень HS, мировой стандарт (5 758)\n\n\n8\nПодсубпозиция\n01012100\nУровень ЕАЭС (10 291)\n\n\n10\nПолный код\n0101210000\nКонкретный объект декларирования (14 155)"
  },
  {
    "objectID": "lesson_01_intro.html#распределение-элементов-по-уровням-январь-2022",
    "href": "lesson_01_intro.html#распределение-элементов-по-уровням-январь-2022",
    "title": "Занятие 1. Введение в таможенную статистику",
    "section": "Распределение элементов по уровням (январь 2022)",
    "text": "Распределение элементов по уровням (январь 2022)\n\n\n\nУровень\nКол-во элементов\nРоль в классификации\n\n\n\n\n2 (Группа)\n97\nКрупные разделы экономики\n\n\n4 (Позиция)\n1 231\nВидовые категории товаров\n\n\n6 (Субпозиция)\n5 758\nМировой стандарт (HS)\n\n\n8 (Подсубпозиция)\n10 291\nРегиональная специфика (ЕАЭС)\n\n\n10 (Товар)\n14 155\nКонкретный объект декларирования\n\n\n\nКоличество записей растёт к 10-му уровню — чем детальнее код, тем больше вариантов."
  },
  {
    "objectID": "lesson_01_intro.html#пример-1-группа-01-живые-животные-из-tnved.csv",
    "href": "lesson_01_intro.html#пример-1-группа-01-живые-животные-из-tnved.csv",
    "title": "Занятие 1. Введение в таможенную статистику",
    "section": "Пример 1: группа 01 (живые животные) — из tnved.csv",
    "text": "Пример 1: группа 01 (живые животные) — из tnved.csv\n01      — ЖИВЫЕ ЖИВОТНЫЕ\n0101    — ЛОШАДИ, ОСЛЫ, МУЛЫ И ЛОШАКИ ЖИВЫЕ\n010121  — ЛОШАДИ ЖИВЫЕ: ЧИСТОПОРОДНЫЕ ПЛЕМЕННЫЕ ЖИВОТНЫЕ\n01012100 — (то же на уровне 8 знаков)\n0101210000 — (полная детализация, 10 знаков)\n010129  — ЛОШАДИ ПРОЧИЕ\n010130  — ОСЛЫ, ЖИВЫЕ\n0102    — КРУПНЫЙ РОГАТЫЙ СКОТ ЖИВОЙ\n0103    — СВИНЬИ ЖИВЫЕ"
  },
  {
    "objectID": "lesson_01_intro.html#пример-2-группа-27-топливо-крупнейшая-по-обороту",
    "href": "lesson_01_intro.html#пример-2-группа-27-топливо-крупнейшая-по-обороту",
    "title": "Занятие 1. Введение в таможенную статистику",
    "section": "Пример 2: группа 27 (топливо) — крупнейшая по обороту",
    "text": "Пример 2: группа 27 (топливо) — крупнейшая по обороту\nГруппа 27 объединяет минеральное топливо: уголь, нефть, нефтепродукты и газы. Иерархия строится по технологическим и химическим признакам (плотность, содержание серы, агрегатное состояние). Ниже — фрагмент дерева от группы до подсубпозиций.\nНефть и нефтепродукты (2710):\n27      — ТОПЛИВО МИНЕРАЛЬНОЕ, НЕФТЬ И ПРОДУКТЫ ИХ ПЕРЕГОНКИ; БИТУМИНОЗНЫЕ ВЕЩЕСТВА; ВОСКИ МИНЕРАЛЬНЫЕ\n2701    — УГОЛЬ КАМЕННЫЙ; БРИКЕТЫ, ОКАТЫШИ...\n2709    — НЕФТЬ СЫРАЯ И НЕФТЕПРОДУКТЫ СЫРЫЕ\n2710    — НЕФТЬ И НЕФТЕПРОДУКТЫ (кроме сырых)\n271012  — ЛЕГКИЕ ДИСТИЛЛЯТЫ (бензины)\n27101241 — БЕНЗИНЫ МОТОРНЫЕ (с октановым числом &lt; 95)\n2710124110 — БЕНЗИН АВТОМОБИЛЬНЫЙ (октановое число &lt; 80)\n271019  — ПРОЧИЕ ДИСТИЛЛЯТЫ (дизель, керосин, мазут)\nПриродный газ — трубопроводный и СПГ (2711):\nВ группе 2711 учитываются углеводородные газы. Ключевое различие для аналитики — способ доставки: по трубам (газообразное состояние) или в сжиженном виде танкерами (СПГ).\n\n\n\n\n\n\n\n\nКод (пример)\nНаименование\nПояснение\n\n\n\n\n2711\nГазы нефтяные и углеводородные газообразные\nВся позиция: природный газ, пропан, бутан и др.\n\n\n2711 11\nПриродный газ сжиженный\nСПГ (LNG) — доставка танкерами, регазификация у потребителя\n\n\n2711 21\nПриродный газ в газообразном состоянии\nТрубопроводный газ — поставки по магистральным газопроводам\n\n\n\nДля России и партнёров разделение 2711 11 (СПГ) и 2711 21 (труба) критично: география, цены и контракты сильно различаются. В зеркальной статистике партнёра код может быть тем же (HS/CN), но единицы измерения и агрегация иногда отличаются от российской практики."
  },
  {
    "objectID": "lesson_01_intro.html#пример-3-группы-84-85-87-машины-и-оборудование",
    "href": "lesson_01_intro.html#пример-3-группы-84-85-87-машины-и-оборудование",
    "title": "Занятие 1. Введение в таможенную статистику",
    "section": "Пример 3: группы 84, 85, 87 — машины и оборудование",
    "text": "Пример 3: группы 84, 85, 87 — машины и оборудование\n84      — РЕАКТОРЫ ЯДЕРНЫЕ, КОТЛЫ, ОБОРУДОВАНИЕ И МЕХАНИЧЕСКИЕ УСТРОЙСТВА; ИХ ЧАСТИ\n85      — ЭЛЕКТРИЧЕСКИЕ МАШИНЫ И ОБОРУДОВАНИЕ; ЗВУКОЗАПИСЫВАЮЩАЯ АППАРАТУРА...\n87      — СРЕДСТВА НАЗЕМНОГО ТРАНСПОРТА (кроме ж/д)\nЭти три группы — среди топ-5 по обороту в данных ФТС 2021–2022."
  },
  {
    "objectID": "lesson_01_intro.html#пример-4-эволюция-кода-смартфоны",
    "href": "lesson_01_intro.html#пример-4-эволюция-кода-смартфоны",
    "title": "Занятие 1. Введение в таможенную статистику",
    "section": "Пример 4: Эволюция кода — смартфоны",
    "text": "Пример 4: Эволюция кода — смартфоны\nПроследим путь классификации одного из самых популярных товаров:\n85           — Электрические машины и оборудование... (Группа)\n8517         — Аппараты телефонные, включая смартфоны... (Позиция)\n851713       — Смартфоны (Субпозиция — введена в 2022 году)\n85171300     — Смартфоны (Подсубпозиция)\n8517130000   — Смартфоны (Полный 10-значный код ТН ВЭД)\nПрефикс «ШТ-» в названии — указание на основную единицу измерения (штуки)."
  },
  {
    "objectID": "lesson_01_intro.html#технические-особенности-данных-tnved.csv",
    "href": "lesson_01_intro.html#технические-особенности-данных-tnved.csv",
    "title": "Занятие 1. Введение в таможенную статистику",
    "section": "Технические особенности данных tnved.csv",
    "text": "Технические особенности данных tnved.csv\nДля аналитики важно понимать структуру файла:\n\n\n\n\n\n\n\nКолонка\nОписание\n\n\n\n\nKOD\nТекстовое поле — сохранять ведущие нули (01, а не 1)\n\n\nNAME\nОфициальное наименование; может содержать единицы измерения (ШТ-, 1000 Л-), технические пояснения\n\n\nlevel\nИндикатор вложенности (2, 4, 6, 8, 10) — упрощает построение древовидных моделей в Excel, Python, Power BI"
  },
  {
    "objectID": "lesson_01_intro.html#особенности-кодирования",
    "href": "lesson_01_intro.html#особенности-кодирования",
    "title": "Занятие 1. Введение в таможенную статистику",
    "section": "Особенности кодирования",
    "text": "Особенности кодирования\n\nДополнение нулями справа: 2710 → 2710000000 (до 10 знаков)\nИерархия: каждый уровень — префикс следующего: 27 → 2701 → 271012 → 27101241 → 2710124110"
  },
  {
    "objectID": "lesson_01_intro.html#зеркальная-статистика",
    "href": "lesson_01_intro.html#зеркальная-статистика",
    "title": "Занятие 1. Введение в таможенную статистику",
    "section": "Зеркальная статистика",
    "text": "Зеркальная статистика\nОпределение: Данные о торговле с РФ, собранные страной-партнёром (а не российской таможней).\nПочему важна: - С января 2022 официальная статистика ФТС недоступна - Зеркальная статистика — единственный легальный источник актуальных данных - Данные партнёров часто публикуются быстрее, чем UN Comtrade\nИсточники в проекте: - Китай (customs.gov.cn) - Индия (commerce.gov.in) - Турция (trademap) - UN Comtrade (для стран без национальных данных)"
  },
  {
    "objectID": "lesson_01_intro.html#почему-прямая-и-зеркальная-статистика-отличаются",
    "href": "lesson_01_intro.html#почему-прямая-и-зеркальная-статистика-отличаются",
    "title": "Занятие 1. Введение в таможенную статистику",
    "section": "Почему прямая и зеркальная статистика отличаются?",
    "text": "Почему прямая и зеркальная статистика отличаются?\n\nCIF vs FOB: Импорт учитывается по CIF (стоимость + страхование + фрахт), экспорт — по FOB (франко-борт)\nСтрана происхождения vs страна отправления: Транзитные операции\nВременной лаг: Морские перевозки — товар в пути\nРазная классификация: Один товар — разные коды ТН ВЭД в разных странах"
  },
  {
    "objectID": "lesson_01_intro.html#структура-проекта",
    "href": "lesson_01_intro.html#структура-проекта",
    "title": "Занятие 1. Введение в таможенную статистику",
    "section": "Структура проекта",
    "text": "Структура проекта\nmgimo-foreign_trade/\n├── data_raw/fts_data/  # CSV ФТС по месяцам (янв 2021 — янв 2022)\n├── data_processed/     # Сводные Parquet (fts_2021_2022.parquet и др.)\n├── src/load_fts_csv.py # Объединение CSV ФТС в сводный датасет\n├── src/collectors/     # Сборщики зеркальной статистики\n├── db/                 # unified_trade_data.duckdb (после merge)\n├── metadata/           # Справочники (страны, ТН ВЭД)\n└── superset/           # Конфигурация дашборда"
  },
  {
    "objectID": "lesson_01_intro.html#модель-данных-схема",
    "href": "lesson_01_intro.html#модель-данных-схема",
    "title": "Занятие 1. Введение в таможенную статистику",
    "section": "Модель данных (схема)",
    "text": "Модель данных (схема)\n\n\n\nКолонка\nТип\nОписание\n\n\n\n\nNAPR\nVARCHAR\nИМ / ЭК\n\n\nPERIOD\nDATE\nОтчётный период (YYYY-MM-DD)\n\n\nSTRANA\nVARCHAR\nISO2 код страны (CN, TR, IN)\n\n\nTNVED\nVARCHAR\nКод ТН ВЭД (8–10 знаков)\n\n\nSTOIM\nDECIMAL\nСтоимость, тыс. USD\n\n\nNETTO\nDECIMAL\nВес нетто, кг\n\n\nKOL\nDECIMAL\nКоличество в доп. единице\n\n\nEDIZM\nVARCHAR\nЕдиница измерения\n\n\nTNVED2, TNVED4, TNVED6\nVARCHAR\nАгрегированные коды"
  },
  {
    "objectID": "lesson_01_intro.html#дополнительные-единицы-измерения-edizm",
    "href": "lesson_01_intro.html#дополнительные-единицы-измерения-edizm",
    "title": "Занятие 1. Введение в таможенную статистику",
    "section": "Дополнительные единицы измерения (EDIZM)",
    "text": "Дополнительные единицы измерения (EDIZM)\nСправочник: metadata/edizm.csv — стандартизированные единицы для колонки KOL.\n\n\n\nKOD\nNAME\n\n\n\n\n166\nКИЛОГРАММ\n\n\n168\nТОННА (1000 КГ)\n\n\n796\nШТУКА\n\n\n798\nТЫСЯЧА ШТУК\n\n\n112\nЛИТР\n\n\n130\n1000 ЛИТРОВ\n\n\n113\nКУБИЧЕСКИЙ МЕТР\n\n\n006\nМЕТР\n\n\n055\nКВАДРАТНЫЙ МЕТР\n\n\n246\n1000 КИЛОВАТТ-ЧАС\n\n\n323\nБЕККЕРЕЛЬ\n\n\n\nРоль: KOL — количество в единице EDIZM. NETTO — всегда вес в кг. Для товаров «в штуках» KOL даёт натуральный объём, для «в литрах» — объём и т.д."
  },
  {
    "objectID": "lesson_01_intro.html#натуральные-показатели",
    "href": "lesson_01_intro.html#натуральные-показатели",
    "title": "Занятие 1. Введение в таможенную статистику",
    "section": "Натуральные показатели",
    "text": "Натуральные показатели\nПомимо стоимости (STOIM) таможенная статистика содержит физические объёмы:\n\n\n\n\n\n\n\n\nПоказатель\nЕдиница\nОписание\n\n\n\n\nNETTO\nкг\nВес нетто — есть почти у всех товаров\n\n\nKOL\nзависит от EDIZM\nКоличество в дополнительной единице (штуки, литры, м², кВт·ч…)\n\n\n\nЗачем нужны: Отделение ценовых эффектов от реальных объёмов. Рост стоимости может быть из-за роста цен или роста поставок — только натуральные показатели показывают реальные потоки."
  },
  {
    "objectID": "lesson_01_intro.html#эффективные-цены-по-категориям",
    "href": "lesson_01_intro.html#эффективные-цены-по-категориям",
    "title": "Занятие 1. Введение в таможенную статистику",
    "section": "Эффективные цены по категориям",
    "text": "Эффективные цены по категориям\nЭффективная цена — стоимость за единицу физического объёма:\n\nДля весовых товаров (NETTO &gt; 0):\nцена за кг = STOIM / NETTO\n(STOIM в тыс. USD → результат в тыс. USD/кг)\nДля штучных/объёмных (KOL &gt; 0, EDIZM = ШТУКА и т.д.):\nцена за единицу = STOIM / KOL\n(при KOL в тыс. шт. — цена за тыс. шт.)\n\nВажно: Сравнивать цены только внутри одной товарной категории (одинаковый TNVED) и одной единицы измерения. Суммарные цены по группе: SUM(STOIM) / SUM(NETTO) или SUM(STOIM) / SUM(KOL)."
  },
  {
    "objectID": "lesson_01_intro.html#прямые-данные-фтс",
    "href": "lesson_01_intro.html#прямые-данные-фтс",
    "title": "Занятие 1. Введение в таможенную статистику",
    "section": "Прямые данные ФТС",
    "text": "Прямые данные ФТС\nИсточник: data_raw/fts_data/ — CSV-файлы по месяцам (янв 2021 — янв 2022).\nЭто прямая статистика российской таможни до её закрытия. Идеальная точка старта для понимания структуры данных."
  },
  {
    "objectID": "lesson_01_intro.html#практика-2-загрузка-и-просмотр-данных-фтс",
    "href": "lesson_01_intro.html#практика-2-загрузка-и-просмотр-данных-фтс",
    "title": "Занятие 1. Введение в таможенную статистику",
    "section": "Практика 2: Загрузка и просмотр данных ФТС",
    "text": "Практика 2: Загрузка и просмотр данных ФТС\n\nimport pandas as pd\nfrom pathlib import Path\n\n# Путь к сводному файлу (запускать из корня проекта)\nparquet_path = ROOT / \"data_interim_csv\" / \"fts_2021_2022.parquet\"\ndf = pd.read_parquet(parquet_path)\n\nprint(f\"Загружено строк: {len(df):,}\")\nprint(f\"Колонки: {df.columns.tolist()}\")\nprint(df.head(10))\n\nЗагружено строк: 1,907,996\nКолонки: ['NAPR', 'STRANA', 'TNVED', 'STOIM', 'NETTO', 'KOL', 'EDIZM', 'PERIOD', 'TNVED2', 'TNVED4', 'TNVED6']\n  NAPR STRANA       TNVED         STOIM         NETTO       KOL EDIZM  \\\n0   ЭК     KZ  9504500002  3.833371e+04  2.353130e+02     495.0   796   \n1   ИМ     BY  9403903000  1.526542e+06  1.045093e+06      27.0  None   \n2   ЭК     BY  9603901000  2.775500e+02  8.045400e+01     261.0   796   \n3   ЭК     PL              1.931287e+08  5.100500e-02       0.0  None   \n4   ЭК     UA              7.243304e+04  4.719465e+04       0.0  None   \n5   ИМ     CZ  9405403902  7.502330e+03  2.616200e+02       0.0  None   \n6   ИМ     TW  9405403109  1.057012e+04  3.188800e+02       0.0  None   \n7   ИМ     DE  9612101000  1.092580e+03  6.400000e+00     112.0   796   \n8   ЭК     RO  9609109000  1.027150e+03  3.978000e+01       0.0  None   \n9   ИМ     CN  9605000000  6.386966e+04  1.024884e+04  191925.0   796   \n\n      PERIOD TNVED2 TNVED4  TNVED6  \n0 2021-01-01     95   9504  950450  \n1 2021-01-01     94   9403  940390  \n2 2021-01-01     96   9603  960390  \n3 2021-01-01                        \n4 2021-01-01                        \n5 2021-01-01     94   9405  940540  \n6 2021-01-01     94   9405  940540  \n7 2021-01-01     96   9612  961210  \n8 2021-01-01     96   9609  960910  \n9 2021-01-01     96   9605  960500"
  },
  {
    "objectID": "lesson_01_intro.html#практика-3-изучение-структуры",
    "href": "lesson_01_intro.html#практика-3-изучение-структуры",
    "title": "Занятие 1. Введение в таможенную статистику",
    "section": "Практика 3: Изучение структуры",
    "text": "Практика 3: Изучение структуры\n\n# Базовая информация\ndf.info()\n\n# Описательная статистика\ndf[['STOIM', 'NETTO', 'KOL']].describe() # не очень показательно \n\n# Направления и страны\nprint(\"Направления:\", df['NAPR'].unique())\nprint(\"Страны (топ-10):\", df['STRANA'].value_counts().head(10))\nprint(\"Период:\", df['PERIOD'].min(), \"—\", df['PERIOD'].max())\n\n&lt;class 'pandas.core.frame.DataFrame'&gt;\nRangeIndex: 1907996 entries, 0 to 1907995\nData columns (total 11 columns):\n #   Column  Dtype         \n---  ------  -----         \n 0   NAPR    object        \n 1   STRANA  object        \n 2   TNVED   object        \n 3   STOIM   float64       \n 4   NETTO   float64       \n 5   KOL     float64       \n 6   EDIZM   object        \n 7   PERIOD  datetime64[ns]\n 8   TNVED2  object        \n 9   TNVED4  object        \n 10  TNVED6  object        \ndtypes: datetime64[ns](1), float64(3), object(7)\nmemory usage: 160.1+ MB\nНаправления: ['ЭК' 'ИМ']\nСтраны (топ-10): STRANA\nBY    148679\nKZ    104104\nUA     78555\nCN     75908\nDE     74997\nIT     56932\nUS     52313\nPL     51539\nAM     48868\nFR     44808\nName: count, dtype: int64\nПериод: 2021-01-01 00:00:00 — 2022-01-01 00:00:00"
  },
  {
    "objectID": "lesson_01_intro.html#практика-4-простые-агрегации-pandas",
    "href": "lesson_01_intro.html#практика-4-простые-агрегации-pandas",
    "title": "Занятие 1. Введение в таможенную статистику",
    "section": "Практика 4: Простые агрегации (pandas)",
    "text": "Практика 4: Простые агрегации (pandas)\nЗадание 1: Сколько записей по каждой стране?\n\nby_country = df.groupby('STRANA').size().sort_values(ascending=False)\nprint(by_country.head(15))\n\nSTRANA\nBY    148679\nKZ    104104\nUA     78555\nCN     75908\nDE     74997\nIT     56932\nUS     52313\nPL     51539\nAM     48868\nFR     44808\nKG     41516\nTR     40623\nUZ     36141\nGB     35852\nJP     34673\ndtype: int64\n\n\nЗадание 2: Сумма импорта и экспорта по странам за весь период\n\nimport_by_country = df[df['NAPR'] == 'ИМ'].groupby('STRANA')['STOIM'].sum().sort_values(ascending=False)\nexport_by_country = df[df['NAPR'] == 'ЭК'].groupby('STRANA')['STOIM'].sum().sort_values(ascending=False)\nprint(\"Импорт (топ-10):\"); print(import_by_country.head(10))\nprint(\"\\nЭкспорт (топ-10):\"); print(export_by_country.head(10))\n\nИмпорт (топ-10):\nSTRANA\nCN    7.987319e+10\nDE    2.893200e+10\nUS    1.836689e+10\nBY    1.650556e+10\nKR    1.440661e+10\nFR    1.287088e+10\nIT    1.278864e+10\nJP    9.896967e+09\nKZ    7.680481e+09\nTR    7.129686e+09\nName: STOIM, dtype: float64\n\nЭкспорт (топ-10):\nSTRANA\nCN    7.375999e+10\nNL    4.695559e+10\nDE    3.319227e+10\nTR    3.084920e+10\nBY    2.421767e+10\nGB    2.334868e+10\nIT    2.150720e+10\nKZ    1.965081e+10\nKR    1.864273e+10\nUS    1.850638e+10\nName: STOIM, dtype: float64"
  },
  {
    "objectID": "lesson_01_intro.html#практика-5-топ-товарных-групп-tnved2",
    "href": "lesson_01_intro.html#практика-5-топ-товарных-групп-tnved2",
    "title": "Занятие 1. Введение в таможенную статистику",
    "section": "Практика 5: Топ товарных групп (TNVED2)",
    "text": "Практика 5: Топ товарных групп (TNVED2)\n\ntop_tnved2 = df.groupby('TNVED2').agg(\n    total_stoim=('STOIM', 'sum'),\n    cnt=('TNVED', 'count')\n).sort_values('total_stoim', ascending=False).head(15)\nprint(top_tnved2)\n\n         total_stoim     cnt\nTNVED2                      \n27      2.336339e+11   20153\n        9.903426e+10    1883\n84      6.988843e+10  232204\n85      4.626939e+10  194388\n72      3.763019e+10   37634\n71      3.431987e+10    6625\n87      3.274077e+10   47071\n39      2.033164e+10   83405\n30      1.733966e+10   16838\n31      1.420929e+10    6283\n44      1.339258e+10   30379\n73      1.120795e+10  101460\n76      1.114235e+10   21224\n90      1.094864e+10   80354\n26      1.031433e+10    1650"
  },
  {
    "objectID": "lesson_01_intro.html#практика-6-единицы-измерения-и-эффективные-цены",
    "href": "lesson_01_intro.html#практика-6-единицы-измерения-и-эффективные-цены",
    "title": "Занятие 1. Введение в таможенную статистику",
    "section": "Практика 6: Единицы измерения и эффективные цены",
    "text": "Практика 6: Единицы измерения и эффективные цены\nЗадание 1: Какие единицы измерения (EDIZM) чаще всего встречаются в данных?\n\nprint(df['EDIZM'].value_counts().head(15))\n\nEDIZM\n796    535920\n055     49612\n715     27488\n113     14285\n112     14166\n831      4485\n163      3518\n861      2309\n798      2059\n845      1272\n852       989\n162       899\n006       778\n130       436\n865       363\nName: count, dtype: int64\n\n\nЗадание 2: Рассчитать среднюю эффективную цену (тыс. USD за тонну) по товарным группам TNVED2 для импорта. Использовать только строки, где NETTO &gt; 0.\n\nimp = df[(df['NAPR'] == 'ИМ') & (df['NETTO'] &gt; 0)]\nprice_by_tnved2 = imp.groupby('TNVED2').agg(\n    total_stoim=('STOIM', 'sum'),\n    total_netto=('NETTO', 'sum')\n)\nprice_by_tnved2['price_per_tonne'] = price_by_tnved2['total_stoim'] / (price_by_tnved2['total_netto'] / 1000)\nprint(price_by_tnved2.sort_values('total_stoim', ascending=False).head(10))\n\n         total_stoim   total_netto  price_per_tonne\nTNVED2                                             \n84      5.853611e+10  4.866623e+09     12028.076734\n85      3.982898e+10  1.983995e+09     20075.145561\n87      2.882560e+10  3.462183e+09      8325.845516\n        1.509862e+10  1.478218e+09     10214.066072\n30      1.472786e+10  1.759806e+08     83690.250251\n39      1.368048e+10  4.638165e+09      2949.545047\n90      9.183333e+09  1.551868e+08     59176.012305\n73      6.978952e+09  2.138294e+09      3263.793910\n29      6.421369e+09  1.841760e+09      3486.539998\n72      6.417894e+09  6.035758e+09      1063.312024\n\n\nЗадание 3: Сравнить эффективные цены импорта из Китая и Германии по группе 2710 (нефтепродукты: бензин, дизель, мазут) за 2021 год. Группа более гомогенна, чем машины.\n\ng2710 = df[(df['NAPR'] == 'ИМ') & (df['TNVED4'] == '2710') & (df['NETTO'] &gt; 0)\n           & (df['PERIOD'].dt.year == 2021) & (df['STRANA'].isin(['CN', 'DE']))]\nby_country = g2710.groupby('STRANA').agg(total_stoim=('STOIM', 'sum'), total_netto=('NETTO', 'sum'))\nby_country['price_per_tonne'] = by_country['total_stoim'] / (by_country['total_netto'] / 1000)\nprint(by_country)\n\n         total_stoim   total_netto  price_per_tonne\nSTRANA                                             \nCN      1.588514e+06  5.628781e+05      2822.127250\nDE      1.311451e+08  3.980568e+07      3294.633576"
  },
  {
    "objectID": "lesson_01_intro.html#итоги-занятия-1",
    "href": "lesson_01_intro.html#итоги-занятия-1",
    "title": "Занятие 1. Введение в таможенную статистику",
    "section": "Итоги занятия 1",
    "text": "Итоги занятия 1\n\nТаможенная статистика — данные о внешней торговле на основе таможенных деклараций\nКлассификаторы — STRANA (страны), TNVED (товары), EDIZM (единицы измерения)\nНатуральные показатели — NETTO (кг), KOL (в единицах EDIZM)\nЭффективная цена — STOIM/NETTO или STOIM/KOL для анализа цен по категориям\nПрямая и зеркальная статистика — ФТС (2021–нач. 2022) и данные партнёров (КНР и др.) для текущих лет; пересечение по 2021 году даёт возможность валидации\nПрактика — сводный датасет ФТС, агрегации, расчёт цен, сравнение ФТС и КНР по группе 27\n\nДомашнее задание\n\nДокументация: Изучить docs/data_model.md, docs/fts_csv_format.md.\nАгрегации по сводному ФТС: Топ-5 стран по импорту за 2021 год. Выполнить Практику 6: эффективные цены по группе 27 для импорта из трёх стран-партнёров.\nСравнение прямой и зеркальной статистики (группа 27):\n\nЗагрузить fts_2021_2022_TNVED2_27.parquet и CN_TNVED2_27.csv.\nПостроить по годам (2019–2025) динамику стоимости по зеркальной статистике КНР: импорт Китая из России и экспорт Китая в Россию (тыс. USD).\nЗа 2021 год: сравнить с агрегатами ФТС (экспорт РФ в КНР и импорт РФ из КНР). Рассчитать относительное расхождение (в %) и кратко предложить возможные причины (FOB/CIF, классификация, лаг).\n\nОтчёт: Оформить результат в виде короткого отчёта (1–2 страницы): таблица или график динамики, таблица сравнения за 2021, выводы.\n\nДополнительно: Найти в metadata/tnved.csv самый длинный текст описания товара (колонка NAME). В группах 84 или 85 описания часто занимают несколько строк — это иллюстрирует сложность таможенного администрирования.\n\n# Поиск самого длинного описания\ntnved = pd.read_csv(ROOT / \"metadata\" / \"tnved.csv\")\ntnved[\"len_name\"] = tnved[\"NAME\"].str.len()\nlongest = tnved.loc[tnved[\"len_name\"].idxmax()]\nprint(longest[\"KOD\"], longest[\"NAME\"][:200] + \"...\")\n\n0307 МОЛЛЮСКИ, В РАКОВИНЕ ИЛИ БЕЗ РАКОВИНЫ, ЖИВЫЕ, СВЕЖИЕ, ОХЛАЖДЕННЫЕ, МОРОЖЕНЫЕ, СУШЕНЫЕ, СОЛЕНЫЕ ИЛИ В РАССОЛЕ; МОЛЛЮСКИ КОПЧЕНЫЕ, В РАКОВИНЕ ИЛИ БЕЗ РАКОВИНЫ, НЕ ПОДВЕРГНУТЫЕ ИЛИ ПОДВЕРГНУТЫЕ ТЕПЛОВОЙ ..."
  },
  {
    "objectID": "lesson_02_old_new_stats.html#план-занятия-80-мин",
    "href": "lesson_02_old_new_stats.html#план-занятия-80-мин",
    "title": "Занятие 2. Старая и новая статистика",
    "section": "План занятия (80 мин)",
    "text": "План занятия (80 мин)\n\nТеория (20 мин): Исторический контекст, различия источников\nПрактика: старая статистика (25 мин): Данные до 2022\nПрактика: новая статистика (30 мин): Данные после 2022, сравнение\nИтоги (5 мин)"
  },
  {
    "objectID": "lesson_02_old_new_stats.html#исторический-контекст",
    "href": "lesson_02_old_new_stats.html#исторический-контекст",
    "title": "Занятие 2. Старая и новая статистика",
    "section": "Исторический контекст",
    "text": "Исторический контекст\n\n\nДо января 2022\n\nОфициальная статистика ФТС\nПрямые данные российской таможни\nВысокая детализация (10 знаков ТН ВЭД)\nПубликация через официальные каналы\nДанные по всем странам-партнёрам\n\n\nПосле января 2022\n\nОфициальная статистика недоступна\nЗеркальная статистика стран-партнёров\nUN Comtrade как доп. источник\nОграниченное покрытие (Китай, Индия, Турция + Comtrade)\nЗадержка публикации в Comtrade (6–12 мес.)"
  },
  {
    "objectID": "lesson_02_old_new_stats.html#источники-данных-в-проекте",
    "href": "lesson_02_old_new_stats.html#источники-данных-в-проекте",
    "title": "Занятие 2. Старая и новая статистика",
    "section": "Источники данных в проекте",
    "text": "Источники данных в проекте\n\n\n\n\n\n\n\n\n\nИсточник\nТип\nПериод\nДетализация\n\n\n\n\nNational (CN, IN, TR)\nЗеркальная\n2005–2025\n8–10 знаков, физические объёмы\n\n\nComtrade\nЗеркальная\nПо годам\nHS6, только страны без national\n\n\nФТС (архив)\nПрямая\nДо 2022\nВ архитектуре, не в текущей БД\n\n\n\nКолонка SOURCE: national или comtrade — откуда пришла запись."
  },
  {
    "objectID": "lesson_02_old_new_stats.html#un-comtrade",
    "href": "lesson_02_old_new_stats.html#un-comtrade",
    "title": "Занятие 2. Старая и новая статистика",
    "section": "UN Comtrade",
    "text": "UN Comtrade\n\nЧто: База ООН по международной торговле\nКак работает: Страны отчитываются о своей торговле; ООН агрегирует\nЗеркальность: Экспорт Китая в РФ = импорт РФ из Китая (с точки зрения РФ)\nОграничения: Задержка до 6–12 мес., уровень HS6, не все страны отчитываются вовремя"
  },
  {
    "objectID": "lesson_02_old_new_stats.html#практика-1-подключение-и-данные-до-2022",
    "href": "lesson_02_old_new_stats.html#практика-1-подключение-и-данные-до-2022",
    "title": "Занятие 2. Старая и новая статистика",
    "section": "Практика 1: Подключение и данные до 2022",
    "text": "Практика 1: Подключение и данные до 2022\nimport duckdb\nfrom pathlib import Path\n\ndb_path = Path(\"db/unified_trade_data.duckdb\")\nconn = duckdb.connect(str(db_path))\n\n# Данные до января 2022\ndf_old = conn.execute(\"\"\"\n    SELECT * FROM unified_trade_data \n    WHERE PERIOD &lt; '2022-01-01'\n    LIMIT 5000\n\"\"\").df()\n\nprint(f\"Строк: {len(df_old)}\")\nprint(f\"Период: {df_old['PERIOD'].min()} — {df_old['PERIOD'].max()}\")\nprint(f\"Страны: {df_old['STRANA'].unique()}\")\nif 'SOURCE' in df_old.columns:\n    print(df_old['SOURCE'].value_counts())"
  },
  {
    "objectID": "lesson_02_old_new_stats.html#практика-2-топ-10-стран-по-импорту-в-2021",
    "href": "lesson_02_old_new_stats.html#практика-2-топ-10-стран-по-импорту-в-2021",
    "title": "Занятие 2. Старая и новая статистика",
    "section": "Практика 2: Топ-10 стран по импорту в 2021",
    "text": "Практика 2: Топ-10 стран по импорту в 2021\ntop_import_2021 = conn.execute(\"\"\"\n    SELECT STRANA, SUM(STOIM) as total_import\n    FROM unified_trade_data\n    WHERE PERIOD &gt;= '2021-01-01' AND PERIOD &lt; '2022-01-01'\n      AND NAPR = 'ИМ'\n    GROUP BY STRANA\n    ORDER BY total_import DESC\n    LIMIT 10\n\"\"\").df()\n\nprint(\"Топ-10 стран по импорту в 2021 (тыс. USD):\")\nprint(top_import_2021)"
  },
  {
    "objectID": "lesson_02_old_new_stats.html#практика-3-динамика-экспорта-по-месяцам-2021",
    "href": "lesson_02_old_new_stats.html#практика-3-динамика-экспорта-по-месяцам-2021",
    "title": "Занятие 2. Старая и новая статистика",
    "section": "Практика 3: Динамика экспорта по месяцам 2021",
    "text": "Практика 3: Динамика экспорта по месяцам 2021\nexport_dynamics = conn.execute(\"\"\"\n    SELECT PERIOD, SUM(STOIM) as total_export\n    FROM unified_trade_data\n    WHERE PERIOD &gt;= '2021-01-01' AND PERIOD &lt; '2022-01-01'\n      AND NAPR = 'ЭК'\n    GROUP BY PERIOD\n    ORDER BY PERIOD\n\"\"\").df()\n\nprint(export_dynamics)\n# Визуализация (опционально):\n# import matplotlib.pyplot as plt\n# export_dynamics.plot(x='PERIOD', y='total_export', kind='line')"
  },
  {
    "objectID": "lesson_02_old_new_stats.html#практика-4-данные-после-января-2022",
    "href": "lesson_02_old_new_stats.html#практика-4-данные-после-января-2022",
    "title": "Занятие 2. Старая и новая статистика",
    "section": "Практика 4: Данные после января 2022",
    "text": "Практика 4: Данные после января 2022\ndf_new = conn.execute(\"\"\"\n    SELECT * FROM unified_trade_data \n    WHERE PERIOD &gt;= '2022-01-01'\n    LIMIT 5000\n\"\"\").df()\n\nprint(f\"Строк: {len(df_new)}\")\nprint(f\"Период: {df_new['PERIOD'].min()} — {df_new['PERIOD'].max()}\")\nif 'SOURCE' in df_new.columns:\n    print(\"\\nПо источникам:\")\n    print(df_new['SOURCE'].value_counts())"
  },
  {
    "objectID": "lesson_02_old_new_stats.html#практика-5-сравнение-топ-5-стран-до-и-после-2022",
    "href": "lesson_02_old_new_stats.html#практика-5-сравнение-топ-5-стран-до-и-после-2022",
    "title": "Занятие 2. Старая и новая статистика",
    "section": "Практика 5: Сравнение топ-5 стран до и после 2022",
    "text": "Практика 5: Сравнение топ-5 стран до и после 2022\nbefore_2022 = conn.execute(\"\"\"\n    SELECT STRANA, SUM(STOIM) as total\n    FROM unified_trade_data\n    WHERE PERIOD &gt;= '2021-01-01' AND PERIOD &lt; '2022-01-01'\n      AND NAPR = 'ИМ'\n    GROUP BY STRANA\n    ORDER BY total DESC\n    LIMIT 5\n\"\"\").df()\n\nafter_2022 = conn.execute(\"\"\"\n    SELECT STRANA, SUM(STOIM) as total\n    FROM unified_trade_data\n    WHERE PERIOD &gt;= '2022-01-01' AND NAPR = 'ИМ'\n    GROUP BY STRANA\n    ORDER BY total DESC\n    LIMIT 5\n\"\"\").df()\n\nprint(\"Топ-5 по импорту 2021:\", before_2022['STRANA'].tolist())\nprint(\"Топ-5 по импорту 2022+:\", after_2022['STRANA'].tolist())"
  },
  {
    "objectID": "lesson_02_old_new_stats.html#практика-6-визуализация-динамики",
    "href": "lesson_02_old_new_stats.html#практика-6-визуализация-динамики",
    "title": "Занятие 2. Старая и новая статистика",
    "section": "Практика 6: Визуализация динамики",
    "text": "Практика 6: Визуализация динамики\nimport matplotlib.pyplot as plt\n\n# Месячная динамика импорта и экспорта 2021–2024\ndynamics = conn.execute(\"\"\"\n    SELECT \n        PERIOD,\n        SUM(CASE WHEN NAPR = 'ИМ' THEN STOIM ELSE 0 END) as import_val,\n        SUM(CASE WHEN NAPR = 'ЭК' THEN STOIM ELSE 0 END) as export_val\n    FROM unified_trade_data\n    WHERE PERIOD &gt;= '2021-01-01'\n    GROUP BY PERIOD\n    ORDER BY PERIOD\n\"\"\").df()\n\nfig, ax = plt.subplots(figsize=(12, 5))\nax.plot(dynamics['PERIOD'], dynamics['import_val'], label='Импорт')\nax.plot(dynamics['PERIOD'], dynamics['export_val'], label='Экспорт')\nax.legend()\nax.set_title('Динамика импорта и экспорта (тыс. USD)')\nplt.xticks(rotation=45)\nplt.tight_layout()\nplt.show()"
  },
  {
    "objectID": "lesson_02_old_new_stats.html#практика-7-сравнение-по-товарным-группам",
    "href": "lesson_02_old_new_stats.html#практика-7-сравнение-по-товарным-группам",
    "title": "Занятие 2. Старая и новая статистика",
    "section": "Практика 7: Сравнение по товарным группам",
    "text": "Практика 7: Сравнение по товарным группам\nЗадание: Сравнить структуру импорта по TNVED2 в 2021 и 2023.\nimport_2021 = conn.execute(\"\"\"\n    SELECT TNVED2, SUM(STOIM) as total\n    FROM unified_trade_data\n    WHERE PERIOD &gt;= '2021-01-01' AND PERIOD &lt; '2022-01-01'\n      AND NAPR = 'ИМ' AND TNVED2 IS NOT NULL\n    GROUP BY TNVED2\n    ORDER BY total DESC\n    LIMIT 10\n\"\"\").df()\n\nimport_2023 = conn.execute(\"\"\"\n    SELECT TNVED2, SUM(STOIM) as total\n    FROM unified_trade_data\n    WHERE PERIOD &gt;= '2023-01-01' AND PERIOD &lt; '2024-01-01'\n      AND NAPR = 'ИМ' AND TNVED2 IS NOT NULL\n    GROUP BY TNVED2\n    ORDER BY total DESC\n    LIMIT 10\n\"\"\").df()\n\nprint(\"Топ-10 TNVED2 по импорту 2021:\\n\", import_2021)\nprint(\"\\nТоп-10 TNVED2 по импорту 2023:\\n\", import_2023)"
  },
  {
    "objectID": "lesson_02_old_new_stats.html#итоги-занятия-2",
    "href": "lesson_02_old_new_stats.html#итоги-занятия-2",
    "title": "Занятие 2. Старая и новая статистика",
    "section": "Итоги занятия 2",
    "text": "Итоги занятия 2\n\nДо 2022: Официальная статистика ФТС, полное покрытие\nПосле 2022: Зеркальная статистика (national + Comtrade)\nSOURCE: Различает national и comtrade\nПрактика: Фильтрация по PERIOD, сравнение периодов, визуализация\n\nДомашнее задание: Провести сравнительный анализ по выбранной стране или товарной группе (TNVED2) за 2021 vs 2023."
  },
  {
    "objectID": "lesson_04_superset.html#план-занятия-80-мин",
    "href": "lesson_04_superset.html#план-занятия-80-мин",
    "title": "Занятие 4. Superset дашборд и визуализация",
    "section": "План занятия (80 мин)",
    "text": "План занятия (80 мин)\n\nВведение в Superset (20 мин)\nСтруктура дашборда (25 мин)\nПрактика: Superset (20 мин) — доступ к инстансу будет предоставлен\nПрактика: Python + визуализация (10 мин)\nИтоги курса (5 мин)"
  },
  {
    "objectID": "lesson_04_superset.html#что-такое-apache-superset",
    "href": "lesson_04_superset.html#что-такое-apache-superset",
    "title": "Занятие 4. Superset дашборд и визуализация",
    "section": "Что такое Apache Superset?",
    "text": "Что такое Apache Superset?\nSuperset — open-source платформа для визуализации данных и бизнес-аналитики.\n\n\n\nВозможность\nОписание\n\n\n\n\nПодключение к БД\nPostgreSQL, DuckDB, MySQL и др.\n\n\nДашборды\nИнтерактивные панели с чартами\n\n\nТипы визуализаций\nГрафики, таблицы, карты, KPI\n\n\nSQL Lab\nВыполнение SQL-запросов\n\n\nФильтры\nДинамическая фильтрация данных"
  },
  {
    "objectID": "lesson_04_superset.html#архитектура-в-проекте",
    "href": "lesson_04_superset.html#архитектура-в-проекте",
    "title": "Занятие 4. Superset дашборд и визуализация",
    "section": "Архитектура в проекте",
    "text": "Архитектура в проекте\nSuperset Instance\n       │\n       ├── Database: DuckDB (unified_trade_data.duckdb)\n       │\n       ├── Datasets: unified_trade_data_enriched, unified_trade_data\n       │\n       ├── Charts: Time Series, Bar, Table, Pie...\n       │\n       └── Dashboard: «Национальная торговая статистика»\nПримечание: Вам будет предоставлен доступ к отдельному инстансу Superset с подключённой базой данных."
  },
  {
    "objectID": "lesson_04_superset.html#основные-элементы-дашборда",
    "href": "lesson_04_superset.html#основные-элементы-дашборда",
    "title": "Занятие 4. Superset дашборд и визуализация",
    "section": "Основные элементы дашборда",
    "text": "Основные элементы дашборда\n\nОбщая статистика — сумма по импорту/экспорту\nДинамика по месяцам — временные ряды\nТоп стран-партнёров — столбчатые диаграммы\nТоварная структура — по TNVED2, TNVED4\nФильтры — период, страна, товарная группа"
  },
  {
    "objectID": "lesson_04_superset.html#типы-визуализаций",
    "href": "lesson_04_superset.html#типы-визуализаций",
    "title": "Занятие 4. Superset дашборд и визуализация",
    "section": "Типы визуализаций",
    "text": "Типы визуализаций\n\n\n\nТип\nНазначение\n\n\n\n\nTime Series\nДинамика импорта/экспорта по месяцам\n\n\nBar Chart\nТоп стран, топ товарных групп\n\n\nTable\nДетализированные данные, экспорт\n\n\nPie Chart\nДоля стран/товаров в общем объёме\n\n\nBig Number\nКлючевые KPI"
  },
  {
    "objectID": "lesson_04_superset.html#sql-lab-в-superset",
    "href": "lesson_04_superset.html#sql-lab-в-superset",
    "title": "Занятие 4. Superset дашборд и визуализация",
    "section": "SQL Lab в Superset",
    "text": "SQL Lab в Superset\nSQL Lab — встроенный редактор для выполнения SQL-запросов.\nSELECT \n    PERIOD,\n    STRANA,\n    SUM(STOIM) as total\nFROM unified_trade_data\nWHERE PERIOD &gt;= '2023-01-01'\nGROUP BY PERIOD, STRANA\nORDER BY PERIOD DESC, total DESC\nLIMIT 100;\nВозможности: Выполнить запрос → создать Chart из результата → добавить на Dashboard."
  },
  {
    "objectID": "lesson_04_superset.html#создание-чарта-пошагово",
    "href": "lesson_04_superset.html#создание-чарта-пошагово",
    "title": "Занятие 4. Superset дашборд и визуализация",
    "section": "Создание чарта: пошагово",
    "text": "Создание чарта: пошагово\n\nData → выбрать Dataset (unified_trade_data_enriched)\nChart type → Bar Chart / Time Series / Table\nMetrics → SUM(STOIM), COUNT(*) и т.д.\nDimensions → STRANA, TNVED2, PERIOD\nFilters → PERIOD, NAPR, STRANA\nSave → сохранить чарт"
  },
  {
    "objectID": "lesson_04_superset.html#практика-1-навигация-по-дашборду",
    "href": "lesson_04_superset.html#практика-1-навигация-по-дашборду",
    "title": "Занятие 4. Superset дашборд и визуализация",
    "section": "Практика 1: Навигация по дашборду",
    "text": "Практика 1: Навигация по дашборду\nЗадание (в Superset):\n\nОткрыть дашборд «Национальная торговая статистика»\nПрименить фильтр по периоду: 2023–2024\nВыбрать страну: Китай (CN)\nНайти данные по импорту за последний доступный месяц\nЭкспортировать таблицу в CSV (если доступно)"
  },
  {
    "objectID": "lesson_04_superset.html#практика-2-sql-lab-простой-запрос",
    "href": "lesson_04_superset.html#практика-2-sql-lab-простой-запрос",
    "title": "Занятие 4. Superset дашборд и визуализация",
    "section": "Практика 2: SQL Lab — простой запрос",
    "text": "Практика 2: SQL Lab — простой запрос\nЗадание (в Superset SQL Lab):\nВыполнить запрос и проверить результат:\nSELECT \n    STRANA,\n    SUM(STOIM) as total_import\nFROM unified_trade_data\nWHERE PERIOD &gt;= '2023-01-01' AND NAPR = 'ИМ'\nGROUP BY STRANA\nORDER BY total_import DESC\nLIMIT 10;\nСоздать из результата простой Bar Chart (если интерфейс позволяет)."
  },
  {
    "objectID": "lesson_04_superset.html#практика-3-python-визуализация-для-отчёта",
    "href": "lesson_04_superset.html#практика-3-python-визуализация-для-отчёта",
    "title": "Занятие 4. Superset дашборд и визуализация",
    "section": "Практика 3: Python — визуализация для отчёта",
    "text": "Практика 3: Python — визуализация для отчёта\nЕсли Superset недоступен во время занятия, используйте Python:\nimport duckdb\nimport matplotlib.pyplot as plt\n\nconn = duckdb.connect(\"db/unified_trade_data.duckdb\")\ndf = conn.execute(\"\"\"\n    SELECT PERIOD, SUM(STOIM) as total\n    FROM unified_trade_data\n    WHERE PERIOD &gt;= '2022-01-01' AND NAPR = 'ИМ'\n    GROUP BY PERIOD\n    ORDER BY PERIOD\n\"\"\").df()\n\nplt.figure(figsize=(10, 5))\nplt.plot(df['PERIOD'], df['total'])\nplt.title('Динамика импорта (тыс. USD)')\nplt.xticks(rotation=45)\nplt.tight_layout()\nplt.savefig('import_dynamics.png')\nplt.show()"
  },
  {
    "objectID": "lesson_04_superset.html#практика-4-сводная-таблица-в-python",
    "href": "lesson_04_superset.html#практика-4-сводная-таблица-в-python",
    "title": "Занятие 4. Superset дашборд и визуализация",
    "section": "Практика 4: Сводная таблица в Python",
    "text": "Практика 4: Сводная таблица в Python\nimport pandas as pd\n\n# Импорт по странам и TNVED2 за 2023\npivot = conn.execute(\"\"\"\n    SELECT STRANA, TNVED2, SUM(STOIM) as total\n    FROM unified_trade_data\n    WHERE PERIOD &gt;= '2023-01-01' AND PERIOD &lt; '2024-01-01'\n      AND NAPR = 'ИМ' AND TNVED2 IN ('27', '84', '85', '87')\n    GROUP BY STRANA, TNVED2\n\"\"\").df()\n\n# Pivot для удобства\npivot_wide = pivot.pivot(index='TNVED2', columns='STRANA', values='total')\nprint(pivot_wide)"
  },
  {
    "objectID": "lesson_04_superset.html#подключение-duckdb-к-superset",
    "href": "lesson_04_superset.html#подключение-duckdb-к-superset",
    "title": "Занятие 4. Superset дашборд и визуализация",
    "section": "Подключение DuckDB к Superset",
    "text": "Подключение DuckDB к Superset\nConnection string (для администратора):\nduckdb:///path/to/db/unified_trade_data.duckdb\nИли через SQLAlchemy:\nduckdb:///db/unified_trade_data.duckdb\nРекомендуемый Dataset: unified_trade_data_enriched — уже содержит названия стран и товаров."
  },
  {
    "objectID": "lesson_04_superset.html#итоги-занятия-4-и-курса",
    "href": "lesson_04_superset.html#итоги-занятия-4-и-курса",
    "title": "Занятие 4. Superset дашборд и визуализация",
    "section": "Итоги занятия 4 и курса",
    "text": "Итоги занятия 4 и курса\nЗанятие 4: - Superset — платформа для визуализации - SQL Lab, создание чартов, дашборды - Доступ к инстансу будет предоставлен отдельно\nВесь курс: 1. Таможенная статистика, ТН ВЭД, зеркальная статистика 2. Старая vs новая статистика (до/после 2022) 3. DuckDB, SQL, аналитические запросы 4. Superset, визуализация, дашборды"
  },
  {
    "objectID": "lesson_04_superset.html#практическое-применение",
    "href": "lesson_04_superset.html#практическое-применение",
    "title": "Занятие 4. Superset дашборд и визуализация",
    "section": "Практическое применение",
    "text": "Практическое применение\n\nАналитики: Оценка рынков, мониторинг потоков, отчёты\nБизнес: Поиск ниш, анализ конкурентов, планирование\nИсследователи: Эмпирические работы, датасеты для моделей\n\nДальнейшее изучение: docs/, sql/, data_analytics/"
  },
  {
    "objectID": "lesson_01_intro.html#пример-5-эволюция-кода-легковые-автомобили",
    "href": "lesson_01_intro.html#пример-5-эволюция-кода-легковые-автомобили",
    "title": "Занятие 1. Введение в таможенную статистику",
    "section": "Пример 5: Эволюция кода — легковые автомобили",
    "text": "Пример 5: Эволюция кода — легковые автомобили\nТранспортные средства (группа 87) — ещё один крупный блок по обороту. Легковые авто — позиция 8703; детализация идёт по типу двигателя и объёму:\n87           — СРЕДСТВА НАЗЕМНОГО ТРАНСПОРТА (кроме ж/д)\n8703         — АВТОМОБИЛИ ЛЕГКОВЫЕ И ПРОЧИЕ ТРАНСПОРТНЫЕ СРЕДСТВА ДЛЯ ПЕРЕВОЗКИ ЛЮДЕЙ\n870321       — с двигателем с искровым зажиганием, объёмом цилиндров ≤ 1000 см³\n870322       — объёмом цилиндров &gt; 1000 см³, но ≤ 1500 см³\n870323       — объёмом цилиндров &gt; 1500 см³, но ≤ 3000 см³\n870324       — объёмом цилиндров &gt; 3000 см³\n8703234190   — пример подсубпозиции (легковые, 1500–3000 см³, прочие)\nНа уровне 6 знаков уже видна ключевая для статистики и пошлин характеристика — объём двигателя; дальше различают тип кузова, экологический класс и т.д."
  },
  {
    "objectID": "lesson_01_intro.html#идея-и-структура-проекта",
    "href": "lesson_01_intro.html#идея-и-структура-проекта",
    "title": "Занятие 1. Введение в таможенную статистику",
    "section": "Идея и структура проекта",
    "text": "Идея и структура проекта\nИдея: Собрать data-product по внешней торговле России на основе зеркальной статистики партнёров. После закрытия данных ФТС это единственный легальный способ получить актуальную картину экспорта и импорта. Задача — не просто хранить сырые выгрузки, а вести единый пайплайн: сбор с сайтов таможен/статслужб → очистка и приведение к общим кодам (страны, ТН ВЭД) → хранение в одной БД → аналитика и дашборды.\nФокус MVP: Китай, Индия, Турция — ключевые партнёры; исторические CSV ФТС (2021–нач. 2022) используются как референс и для сопоставления с зеркальными данными.\nЦелевая аудитория: участники ВЭД, логистика, инвестиционная аналитика; плюс учебные материалы для МГИМО.\nСтруктура репозитория:\nmgimo-foreign_trade/\n├── data_raw/fts_data/  # CSV ФТС по месяцам (янв 2021 — янв 2022)\n├── data_processed/     # Сводные Parquet (fts_2021_2022.parquet и др.)\n├── src/load_fts_csv.py # Объединение CSV ФТС в сводный датасет\n├── src/collectors/     # Сборщики зеркальной статистики\n├── db/                 # unified_trade_data.duckdb (после merge)\n├── metadata/           # Справочники (страны, ТН ВЭД)\n└── superset/           # Конфигурация дашборда"
  },
  {
    "objectID": "lesson_01_intro.html#прямая-и-зеркальная-статистика-группа-27-топливо",
    "href": "lesson_01_intro.html#прямая-и-зеркальная-статистика-группа-27-топливо",
    "title": "Занятие 1. Введение в таможенную статистику",
    "section": "Прямая и зеркальная статистика: группа 27 (топливо)",
    "text": "Прямая и зеркальная статистика: группа 27 (топливо)\nВ проекте для группы 27 (минеральное топливо, нефть, газ) доступны два набора данных:\n\n\n\n\n\n\n\n\nФайл\nОписание\nПериод\n\n\n\n\ndata_interim_csv/fts_2021_2022_TNVED2_27.parquet\nПрямые данные ФТС — российская таможенная статистика по коду 27\nянв 2021 — янв 2022\n\n\ndata_interim_csv/CN_TNVED2_27.csv\nЗеркальная статистика КНР — данные таможни Китая по коду 27 (торговля Китая с Россией)\n2019–2025\n\n\n\nЗачем два источника: Прямая статистика ФТС после января 2022 года недоступна. Зеркальная (данные партнёра) даёт возможность анализировать текущие годы. Пересечение по 2021 году позволяет сопоставить прямую и зеркальную статистику и оценить расхождения (CIF/FOB, классификация, лаги).\nНаправления: В зеркальной статистике КНР направление уже задано с точки зрения партнёра: NAPR=ИМ — импорт Китая из РФ, NAPR=ЭК — экспорт Китая в РФ; менять кодировку не нужно. При сопоставлении с ФТС: российский экспорт в Китай = ФТС NAPR=ЭК, STRANA=CN = в данных КНР NAPR=ИМ; российский импорт из Китая = ФТС NAPR=ИМ, STRANA=CN = в данных КНР NAPR=ЭК."
  }
]