# Документация и инструкция по использованию `turkey_collector.py` и `turkey_processor.py`

## 1. Назначение скриптов

### `turkey_collector.py`
Скрипт предназначен для автоматического сбора **сырых данных** по внешней торговле между Росией и Турцией с сайта института статистики Турции ([biruni.tuik.gov.tr](https://biruni.tuik.gov.tr/disticaretapp/disticaret_ing.zul?param1=4&param2=24&sitcrev=0&isicrev=0&sayac=5902")) . 
Скрипт открывает страницу с формой для запроса данных, заполняет неоходимые поля, отправляет запрос и собирает следующее:

- список и описание кодов ТНВЭД, сохраняет их в json-файл
- html страницы с данными по кодам ТНВЭД

### `turkey_processor.py`
Скрипт предназначен для **обработки, проверки качества и объединения** всех сырых файлов, собранных `turkey_collector.py`. Он сканирует директорию с с данными в виде html страниц, консолидирует их результирующую таблицу и приводит ее к гармонизированному виду на основании [модели данных](https://github.com/quantviews/mgimo-foreign-trade/blob/main/docs/data_model.md) и сохраняет результат в виде parquet файла.

## 2. Использование

[Схема процесса сбора и обработки данных](https://github.com/quantviews/mgimo-foreign-trade/blob/main/fig/turkey-data-collection.png)

### Шаг 1: Сбор сырых данных с `turkey_collector.py`

1.  **Загрузка кодов и сырых данных** Пользователь запускает скрипт из командной строки, указывая год:
    ```bash
    % python turkey_collector.py 2025 
    ```
2.  **Загрузка только кодов** Пользователь запускает скрипт из командной строки указывая ключ -с и год:
    ```bash
    % python turkey_collector.py -с 2025 
    ```

### Шаг 2: Обработка данных с `turkey_processor.py`

1.  **Обработка данных за определенный год** Пользователь запускает скрипт указывая необходимый год.
    ```bash
    % python turkey_processor.py 2025
    ```
2.  **Обработка всех доступных данных** Пользователь запускает скрипт с ключом -a
    ```bash
    % python turkey_processor.py -a
    ```

## 3. Требования

Cторонние Python библиотеки: 
- playwright, 
- pandas, 
- numpy, 
- bs4 (BeautifulSoup)

## 4. Связанные файлы

-   **`turkey_collector.py`**: Скрипт для выгрузки кодов и сырых данных.
-   **`turkey_processor.py`**: Скрипт для обработки и объединения сырых данных.
-   **`data_raw/turkey/raw_html_tables/`**: Директория для хранения сырых данных (html страниц)
-   **`data_raw/turkey/hs_codes_json/`**: Директория для json-файлов с HS8 кодами
-   **`data_processed/tr_full.parquet`**: Финальный, обработанный файл с данными.

